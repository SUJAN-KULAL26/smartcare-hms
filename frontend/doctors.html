<!DOCTYPE html>
<html>
<head>
  <title>SmartCare HMS - Doctors</title>

  <style>
    * {
      box-sizing: border-box;
    }

    body {
      margin:0;
      font-family:'Segoe UI',sans-serif;
      background: linear-gradient(135deg,#0f2027,#203a43,#2c5364);
      min-height:100vh;
      color:white;
      position:relative;
      overflow-x:hidden;
    }

    /* Background Glow */
    body::before, body::after {
      content:"";
      position:absolute;
      width:400px;
      height:400px;
      border-radius:50%;
      filter:blur(150px);
      z-index:-1;
    }

    body::before {
      background: rgba(0,123,255,0.3);
      top:-150px;
      left:-150px;
    }

    body::after {
      background: rgba(0,255,255,0.2);
      bottom:-150px;
      right:-150px;
    }

    /* NAVBAR */
    .navbar {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(12px);
      padding:15px 30px;
      display:flex;
      gap:25px;
      align-items:center;
      border-bottom:1px solid rgba(255,255,255,0.15);
    }

    .navbar a {
      color:#ddd;
      text-decoration:none;
      font-weight:500;
      transition:0.3s;
    }

    .navbar a:hover {
      color:#00c6ff;
    }

    .navbar button {
      margin-left:auto;
      background: linear-gradient(90deg,#00c6ff,#0072ff);
      border:none;
      padding:8px 18px;
      border-radius:25px;
      color:white;
      cursor:pointer;
      font-weight:bold;
    }

    .container {
      padding:40px;
      max-width:1200px;
      margin:auto;
    }

    h3 {
      margin-bottom:20px;
      color:#ddd;
    }

    /* GLASS CARD */
    .card {
      background: rgba(255,255,255,0.08);
      backdrop-filter: blur(15px);
      padding:25px;
      border-radius:20px;
      box-shadow:0 20px 40px rgba(0,0,0,0.4);
      border:1px solid rgba(255,255,255,0.15);
      margin-bottom:30px;
    }

    /* FORM */
    .form-row {
      display:flex;
      gap:15px;
      flex-wrap:wrap;
    }

    input {
      padding:12px;
      border-radius:12px;
      border:1px solid rgba(255,255,255,0.2);
      background: rgba(255,255,255,0.08);
      color:white;
      flex:1;
      min-width:160px;
      outline:none;
      transition:0.3s;
    }

    input:focus {
      border-color:#00c6ff;
    }

    .primary-btn {
      background: linear-gradient(90deg,#00c6ff,#0072ff);
      border:none;
      border-radius:25px;
      padding:12px 25px;
      cursor:pointer;
      color:white;
      font-weight:bold;
      transition:0.3s;
    }

    .primary-btn:hover {
      transform:translateY(-3px);
    }

    .delete-btn {
      background:#dc3545;
      border:none;
      padding:6px 12px;
      border-radius:8px;
      color:white;
      cursor:pointer;
    }

    /* TABLE */
    table {
      width:100%;
      border-collapse:collapse;
    }

    th, td {
      padding:14px;
      text-align:center;
    }

    th {
      background: rgba(255,255,255,0.15);
      color:#ddd;
    }

    tr {
      border-bottom:1px solid rgba(255,255,255,0.1);
    }

    tr:hover {
      background: rgba(255,255,255,0.05);
    }

    td button {
      margin:3px;
      padding:6px 12px;
      border-radius:8px;
      border:none;
      cursor:pointer;
    }

  </style>
</head>

<body>

<div class="navbar">
  <a href="/dashboard.html">Dashboard</a>
  <a href="/patients.html">Patients</a>
  <a href="/doctors.html">Doctors</a>
  <a href="/appointments.html">Appointments</a>
  <a href="/billing.html">Billing</a>
  <a href="/reports.html">Reports</a>
  <button onclick="logout()">Logout</button>
</div>

<div class="container">

  <div class="card">
    <h3>Add / Update Doctor</h3>
    <div class="form-row">
      <input type="text" id="dname" placeholder="Doctor Name">
      <input type="text" id="dspecialization" placeholder="Specialization">
      <input type="number" id="dexperience" placeholder="Experience (Years)">
      <input type="text" id="dcontact" placeholder="Contact">
      <button class="primary-btn" onclick="handleDoctor()">Save</button>
    </div>
  </div>

  <div class="card">
    <h3>Doctor List</h3>
    <table>
      <thead>
        <tr>
          <th>Name</th>
          <th>Specialization</th>
          <th>Experience</th>
          <th>Contact</th>
          <th>Action</th>
        </tr>
      </thead>
      <tbody id="doctorTable"></tbody>
    </table>
  </div>

</div>

<script>
document.addEventListener("DOMContentLoaded", function(){

let editingDoctorId=null;
const token=localStorage.getItem("token");
const API="https://smartcare-hms-backend.onrender.com/api";

if(!token){
  window.location.href="/";
  return;
}

async function loadDoctors(){
  const res=await fetch(`${API}/doctors`,{
    headers:{ Authorization:"Bearer "+token }
  });

  const data=await res.json();
  const table=document.getElementById("doctorTable");
  table.innerHTML="";

  data.forEach(d=>{
    table.innerHTML+=`
      <tr>
        <td>${d.name}</td>
        <td>${d.specialization}</td>
        <td>${d.experience||0}</td>
        <td>${d.contact}</td>
        <td>
          <button onclick="editDoctor('${d._id}','${d.name}','${d.specialization}','${d.experience}','${d.contact}')">Edit</button>
          <button class="delete-btn" onclick="deleteDoctor('${d._id}')">Delete</button>
        </td>
      </tr>`;
  });
}

window.editDoctor=function(id,name,specialization,experience,contact){
  editingDoctorId=id;
  dname.value=name;
  dspecialization.value=specialization;
  dexperience.value=experience;
  dcontact.value=contact;
};

window.handleDoctor=async function(){
  const body={
    name:dname.value,
    specialization:dspecialization.value,
    experience:Number(dexperience.value),
    contact:dcontact.value
  };

  if(editingDoctorId){
    await fetch(`${API}/doctors/${editingDoctorId}`,{
      method:"PUT",
      headers:{
        "Content-Type":"application/json",
        Authorization:"Bearer "+token
      },
      body:JSON.stringify(body)
    });
  } else {
    await fetch(`${API}/doctors`,{
      method:"POST",
      headers:{
        "Content-Type":"application/json",
        Authorization:"Bearer "+token
      },
      body:JSON.stringify(body)
    });
  }

  editingDoctorId=null;
  dname.value="";
  dspecialization.value="";
  dexperience.value="";
  dcontact.value="";

  loadDoctors();
};

window.deleteDoctor=async function(id){
  await fetch(`${API}/doctors/${id}`,{
    method:"DELETE",
    headers:{ Authorization:"Bearer "+token }
  });
  loadDoctors();
};

window.logout=function(){
  localStorage.clear();
  window.location.href="/";
};

loadDoctors();

});
</script>

</body>
</html>